VERSION=8.10.1
NAMESPACE=my-elk-stack

----

version: '3.3'

services:
  metricbeat:
    image: "docker.elastic.co/beats/metricbeat:${VERSION}"
    container_name: "${NAMESPACE}_metricbeat"
    user: root
    volumes:
      - ./config/metricbeat.yml:/etc/metricbeat/metricbeat.yml:ro
      - /sys/fs/cgroup:/hostfs/sys/fs/cgroup:ro
      - /proc:/hostfs/proc:ro
      - /:/hostfs:ro
    network_mode: host

  filebeat:
    image: "docker.elastic.co/beats/filebeat:${VERSION}"
    container_name: "${NAMESPACE}_filebeat"
    user: root
    volumes:
      - ./config/filebeat.yml:/etc/filebeat/filebeat.yml:ro
      - /var/log:/usr/share/filebeat/logs:ro
    network_mode: host

  heartbeat:
    image: "docker.elastic.co/beats/heartbeat:${VERSION}"
    container_name: "${NAMESPACE}_heartbeat"
    volumes:
      - ./config/heartbeat.yml:/etc/heartbeat/heartbeat.yml:ro
    network_mode: host

  auditbeat:
    image: "docker.elastic.co/beats/auditbeat:${VERSION}"
    container_name: "${NAMESPACE}_auditbeat"
    user: root
    volumes:
      - ./config/auditbeat.yml:/etc/auditbeat/auditbeat.yml:ro
      - /proc:/hostfs/proc:ro
      - /:/hostfs:ro
    network_mode: host

x-logging:
  options:
    max-size: "10m"
    max-file: "5"

logging:
  driver: "json-file"
  options:
    max-size: "10m"
    max-file: "5"
